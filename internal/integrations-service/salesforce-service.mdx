---
title: salesforce.do
description: Salesforce on the Edge - A managed Salesforce CRM proxy running on Cloudflare Workers with caching, batching, and AI agent support.
---

# salesforce.do

**Salesforce on the Edge** - A managed Salesforce proxy that runs on Cloudflare Workers, with built-in caching, request batching, and native AI agent support.

```typescript
import { SalesforceClient } from 'salesforce.do'

const client = new SalesforceClient('https://your-worker.workers.dev')

// It's just Salesforce
const accounts = await client.query(
  "SELECT Id, Name, Industry FROM Account WHERE Industry = 'Technology'"
)

await client.create('Account', {
  Name: 'Acme Inc',
  Industry: 'Technology',
})
```

<Callout type="info">
Looking for jsforce compatibility? See [@dotdo/salesforce](/docs/integrations/salesforce/package) for a drop-in replacement that works in edge environments.
</Callout>

## Why salesforce.do?

Traditional Salesforce integrations face challenges with rate limits, latency, and connection management. salesforce.do eliminates these issues by running a smart proxy on Cloudflare's edge network:

- **Zero Infrastructure** - No servers to manage, no connection limits, no cold starts
- **Intelligent Caching** - Automatic response caching with smart invalidation
- **Request Batching** - Combine multiple operations into single API calls
- **Token Management** - Automatic OAuth token refresh and rotation
- **AI-Native** - Built-in MCP protocol support for LLM tool calling
- **Rate Limit Handling** - Intelligent queuing and retry logic

## Features

### Core CRM Operations

| Feature | Description |
|---------|-------------|
| **SOQL Queries** | Full SOQL support with result caching |
| **SObject CRUD** | Create, read, update, delete with automatic batching |
| **Bulk API** | Large data operations with streaming support |
| **Reports** | Execute and cache report results |
| **Metadata** | Object describe with aggressive caching |

### Edge Optimization

| Feature | Description |
|---------|-------------|
| **Response Caching** | Configurable TTL caching for queries and describes |
| **Request Batching** | Automatic composite API batching |
| **Connection Pooling** | Efficient Salesforce connection reuse |
| **Token Management** | Automatic OAuth refresh with secure storage |
| **Rate Limit Queue** | Intelligent request queuing during throttling |

### AI & Agents

| Feature | Description |
|---------|-------------|
| **MCP Protocol** | Model Context Protocol server for Claude and other LLMs |
| **Tool Definitions** | Pre-built Salesforce tools for AI agents |
| **Schema Introspection** | Automatic object schema discovery |
| **Query Generation** | AI-friendly SOQL query helpers |

## Installation

```bash
npm install salesforce.do
```

## Quick Start

### Deploy to Cloudflare Workers

```typescript
// src/index.ts
import { SalesforceEntrypoint, SalesforceProxy } from 'salesforce.do'

export { SalesforceProxy }
export default SalesforceEntrypoint
```

```jsonc
// wrangler.jsonc
{
  "name": "my-salesforce-do",
  "main": "src/index.ts",
  "compatibility_date": "2025-01-01",
  "compatibility_flags": ["nodejs_compat"],
  "durable_objects": {
    "bindings": [{ "name": "SALESFORCE_PROXY", "class_name": "SalesforceProxy" }]
  },
  "migrations": [{ "tag": "v1", "new_sqlite_classes": ["SalesforceProxy"] }],
  "vars": {
    "SF_LOGIN_URL": "https://login.salesforce.com",
    "SF_API_VERSION": "59.0"
  }
}
```

```bash
# Set secrets
npx wrangler secret put SF_CLIENT_ID
npx wrangler secret put SF_CLIENT_SECRET
npx wrangler secret put SF_USERNAME
npx wrangler secret put SF_PASSWORD

npx wrangler deploy
```

### Client Usage

```typescript
import { SalesforceClient } from 'salesforce.do/client'

const client = new SalesforceClient({
  baseUrl: 'https://your-salesforce.workers.dev',
  timeout: 30000,
  headers: {
    'Authorization': 'Bearer your-api-key'
  }
})

// Query with automatic caching
const accounts = await client.query(
  "SELECT Id, Name, Industry FROM Account WHERE Industry = 'Technology'"
)

// Create with automatic batching
const result = await client.create('Account', {
  Name: 'New Account',
  Industry: 'Technology',
})

// Bulk operations
const results = await client.createMany('Contact', [
  { FirstName: 'John', LastName: 'Doe', Email: 'john@example.com' },
  { FirstName: 'Jane', LastName: 'Smith', Email: 'jane@example.com' },
])
```

## Examples

### SOQL Queries with Caching

```typescript
// Cached query (default 5 minute TTL)
const accounts = await client.query(
  "SELECT Id, Name, Industry FROM Account LIMIT 100"
)

// Force fresh data
const freshAccounts = await client.query(
  "SELECT Id, Name, Industry FROM Account LIMIT 100",
  { cache: false }
)

// Custom cache TTL
const cachedAccounts = await client.query(
  "SELECT Id, Name, Industry FROM Account LIMIT 100",
  { cacheTTL: 3600 } // 1 hour
)
```

### SObject CRUD Operations

```typescript
// Create
const account = await client.create('Account', {
  Name: 'Acme Inc',
  Industry: 'Technology',
  Website: 'https://acme.com',
})

// Read
const record = await client.get('Account', account.id)

// Update
await client.update('Account', account.id, {
  Description: 'Updated description',
})

// Delete
await client.delete('Account', account.id)

// Upsert by external ID
await client.upsert('Account', 'External_ID__c', 'EXT-001', {
  Name: 'Upserted Account',
})
```

### Batch Operations

salesforce.do automatically batches operations when possible:

```typescript
// These are automatically batched into a single Composite API call
const [account1, account2, contacts] = await Promise.all([
  client.create('Account', { Name: 'Account 1' }),
  client.create('Account', { Name: 'Account 2' }),
  client.query("SELECT Id, Name FROM Contact LIMIT 10"),
])

// Explicit batch for bulk creates
const results = await client.createMany('Lead', [
  { LastName: 'Lead 1', Company: 'Company A' },
  { LastName: 'Lead 2', Company: 'Company B' },
  { LastName: 'Lead 3', Company: 'Company C' },
  // ... up to 200 records batched automatically
])
```

### Bulk API for Large Datasets

```typescript
// Bulk insert
const job = await client.bulk.insert('Account', [
  { Name: 'Bulk Account 1', Industry: 'Technology' },
  { Name: 'Bulk Account 2', Industry: 'Finance' },
  // ... thousands of records
])

// Monitor job progress
const status = await client.bulk.status(job.id)
console.log(`Progress: ${status.recordsProcessed}/${status.totalRecords}`)

// Get results
const results = await client.bulk.results(job.id)

// Bulk query
const queryJob = await client.bulk.query(
  "SELECT Id, Name, Industry FROM Account"
)
const records = await client.bulk.queryResults(queryJob.id)
```

### AI Agent with MCP

```typescript
import { createMcpServer, createAnthropicAdapter } from 'salesforce.do/mcp'
import Anthropic from '@anthropic-ai/sdk'

const server = createMcpServer({ client })
const adapter = createAnthropicAdapter({ server })
await adapter.initialize()

const anthropic = new Anthropic()
const response = await anthropic.messages.create({
  model: 'claude-sonnet-4-20250514',
  tools: await adapter.getTools(),
  messages: [{
    role: 'user',
    content: 'Find all Technology accounts with revenue over $1M and create a summary report'
  }]
})
```

### Object Schema Discovery

```typescript
// Get object metadata (cached)
const accountSchema = await client.describe('Account')

console.log('Fields:')
for (const field of accountSchema.fields) {
  console.log(`  ${field.name} (${field.type}) - ${field.label}`)
}

// List all objects
const allObjects = await client.describeGlobal()
const customObjects = allObjects.sobjects.filter(obj => obj.custom)
```

### Reports

```typescript
// Execute a report
const report = await client.report('00Oxx0000004567AAA')

// Execute with filters
const filteredReport = await client.report('00Oxx0000004567AAA', {
  reportFilters: [
    { column: 'ACCOUNT.INDUSTRY', operator: 'equals', value: 'Technology' }
  ]
})

// Async execution for large reports
const instance = await client.reportAsync('00Oxx0000004567AAA')
const status = await client.reportStatus(instance.id)
```

## Architecture

```
+-----------------------------------------------------------------+
|                      Client Applications                         |
+-----------------------------------------------------------------+
                              |
                              v
+-----------------------------------------------------------------+
|                    salesforce.do Worker                          |
+-----------------------------------------------------------------+
|  Query Cache  |  Request Batcher  |  Token Manager  |    MCP     |
+-----------------------------------------------------------------+
|  Rate Limiter |   Retry Logic     |  Connection Pool |  Metrics  |
+-----------------------------------------------------------------+
|                    Durable Object State                          |
+-----------------------------------------------------------------+
                              |
                              v
+-----------------------------------------------------------------+
|                      Salesforce APIs                             |
|    REST API    |    Bulk API 2.0    |    Composite API           |
+-----------------------------------------------------------------+
```

salesforce.do acts as an intelligent proxy layer:

1. **Request Reception** - Receives requests at the edge
2. **Cache Check** - Returns cached data when valid
3. **Request Batching** - Combines multiple requests into Composite API calls
4. **Token Management** - Handles OAuth tokens with automatic refresh
5. **Rate Limiting** - Queues requests during Salesforce throttling
6. **Response Caching** - Caches responses with configurable TTLs
7. **Metrics Collection** - Tracks usage and performance

## Configuration

### Environment Variables

```bash
# Required
SF_CLIENT_ID=your_connected_app_client_id
SF_CLIENT_SECRET=your_connected_app_client_secret
SF_USERNAME=integration_user@example.com
SF_PASSWORD=password+securitytoken

# Optional
SF_LOGIN_URL=https://login.salesforce.com  # or test.salesforce.com
SF_API_VERSION=59.0
SF_CACHE_TTL=300                            # Default cache TTL in seconds
SF_MAX_BATCH_SIZE=25                        # Composite API batch size
```

### Wrangler Configuration

```jsonc
{
  "name": "salesforce-proxy",
  "main": "src/index.ts",
  "compatibility_date": "2025-01-01",
  "compatibility_flags": ["nodejs_compat"],
  "durable_objects": {
    "bindings": [
      { "name": "SALESFORCE_PROXY", "class_name": "SalesforceProxy" }
    ]
  },
  "migrations": [
    { "tag": "v1", "new_sqlite_classes": ["SalesforceProxy"] }
  ],
  "vars": {
    "SF_LOGIN_URL": "https://login.salesforce.com",
    "SF_API_VERSION": "59.0",
    "SF_CACHE_TTL": "300"
  }
}
```

### Cache Configuration

```typescript
const client = new SalesforceClient({
  baseUrl: 'https://your-salesforce.workers.dev',
  cache: {
    query: 300,       // SOQL query cache TTL (seconds)
    describe: 3600,   // Object describe cache TTL
    report: 600,      // Report results cache TTL
  }
})
```

## HTTP API Endpoints

### Query Endpoints

- `POST /query` - Execute SOQL query
- `POST /queryAll` - Execute SOQL including deleted records

### SObject Endpoints

- `GET /sobjects/:type/:id` - Get record by ID
- `POST /sobjects/:type` - Create record
- `PATCH /sobjects/:type/:id` - Update record
- `DELETE /sobjects/:type/:id` - Delete record
- `PATCH /sobjects/:type/:externalIdField/:externalId` - Upsert by external ID

### Bulk Endpoints

- `POST /bulk/:type/insert` - Bulk insert job
- `POST /bulk/:type/update` - Bulk update job
- `POST /bulk/:type/upsert` - Bulk upsert job
- `POST /bulk/:type/delete` - Bulk delete job
- `POST /bulk/query` - Bulk query job
- `GET /bulk/:jobId/status` - Job status
- `GET /bulk/:jobId/results` - Job results

### Metadata Endpoints

- `GET /describe` - Describe global (all objects)
- `GET /describe/:type` - Describe specific object

### Report Endpoints

- `POST /reports/:id/execute` - Execute report
- `POST /reports/:id/executeAsync` - Async report execution
- `GET /reports/:id/instances/:instanceId` - Get async report status

### Admin Endpoints

- `GET /limits` - Get org API limits
- `GET /identity` - Get current user info
- `GET /health` - Health check
- `GET /metrics` - Usage metrics

## API Reference

### SalesforceClient

```typescript
new SalesforceClient(config: SalesforceClientConfig)
```

| Config Option | Type | Default | Description |
|--------------|------|---------|-------------|
| `baseUrl` | `string` | *required* | salesforce.do service URL |
| `timeout` | `number` | `30000` | Request timeout (ms) |
| `headers` | `object` | `{}` | Default headers |
| `cache` | `CacheConfig` | `{}` | Cache TTL configuration |
| `fetch` | `function` | `globalThis.fetch` | Custom fetch implementation |

### Query Methods

- `query(soql, options?)` - Execute SOQL query
- `queryAll(soql, options?)` - Query including deleted records

### SObject Methods

- `get(type, id, fields?)` - Get record by ID
- `create(type, data)` - Create record
- `update(type, id, data)` - Update record
- `delete(type, id)` - Delete record
- `upsert(type, externalIdField, externalId, data)` - Upsert by external ID
- `createMany(type, records)` - Batch create records
- `updateMany(type, records)` - Batch update records
- `deleteMany(type, ids)` - Batch delete records

### Bulk Methods

- `bulk.insert(type, records)` - Bulk insert job
- `bulk.update(type, records)` - Bulk update job
- `bulk.upsert(type, externalIdField, records)` - Bulk upsert job
- `bulk.delete(type, ids)` - Bulk delete job
- `bulk.query(soql)` - Bulk query job
- `bulk.status(jobId)` - Get job status
- `bulk.results(jobId)` - Get job results

### Metadata Methods

- `describe(type)` - Describe object
- `describeGlobal()` - Describe all objects

### Report Methods

- `report(id, options?)` - Execute report
- `reportAsync(id, options?)` - Async report execution
- `reportStatus(instanceId)` - Get async report status

## Rate Limit Handling

salesforce.do intelligently handles Salesforce rate limits:

```typescript
// Automatic retry with exponential backoff
const result = await client.query('SELECT Id FROM Account')

// Configure retry behavior
const client = new SalesforceClient({
  baseUrl: 'https://your-salesforce.workers.dev',
  retries: {
    maxRetries: 3,
    initialDelay: 1000,
    maxDelay: 30000,
    retryOn: ['RATE_LIMIT', 'SERVER_ERROR']
  }
})
```

## Development

```bash
# Install dependencies
npm install

# Run locally
npm run dev

# Run tests
npm test

# Type check
npm run typecheck

# Deploy
npm run deploy
```

## Related

- [@dotdo/salesforce](/docs/integrations/salesforce/package) - jsforce-compatible package
- [Stripe Integration](/docs/integrations/stripe) - Payment processing
- [HubSpot Integration](/docs/integrations/hubspot) - Marketing automation
- [Durable Objects](/docs/architecture/durable-objects) - DO-backed storage

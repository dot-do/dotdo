---
title: Agent Tools
description: Give agents capabilities with the unified tool system
---

# Agent Tools

Tools give agents capabilities. Read files. Run commands. Search code. Commit changes. Tools transform agents from chat assistants into workers.

```typescript
import { tool, AGENT_TOOLS, getTool, executeTool } from 'dotdo/agents'
import { z } from 'zod'

// Create a custom tool
const analyzeCode = tool({
  name: 'analyzeCode',
  description: 'Analyze code for patterns and issues',
  inputSchema: z.object({
    code: z.string().describe('The code to analyze'),
    language: z.enum(['typescript', 'javascript', 'python']),
  }),
  execute: async ({ code, language }) => {
    // Analysis logic...
    return { issues: [], suggestions: [] }
  },
})
```

## Overview

The tool system provides a unified interface that works across all agent providers:

- **Vercel AI SDK** - Zod schemas
- **OpenAI** - JSON Schema
- **Claude** - MCP-compatible
- **Custom Providers** - Any schema format

Write tools once, use them everywhere.

---

## Built-in Tools

Every agent has access to built-in tools for file operations, shell commands, and Git.

### File Tools

```typescript
import { writeFileTool, readFileTool, editFileTool } from 'dotdo/agents/tools'

// Write a file (creates directories if needed)
await writeFileTool.execute({
  path: '/path/to/file.ts',
  content: 'export const hello = "world"',
})

// Read a file
const result = await readFileTool.execute({
  path: '/path/to/file.ts',
})
// result.content contains the file contents

// Edit a file (find and replace)
await editFileTool.execute({
  path: '/path/to/file.ts',
  old_string: 'const value = 1',
  new_string: 'const value = 42',
})
```

### Shell Tools

```typescript
import { bashTool, globTool, grepTool } from 'dotdo/agents/tools'

// Execute a shell command
const result = await bashTool.execute({
  command: 'npm test',
  cwd: '/path/to/project',
})
// result.stdout, result.stderr

// Find files by pattern
const files = await globTool.execute({
  pattern: '*.ts',
  cwd: '/path/to/project',
})
// files.files contains matching paths

// Search file contents
const matches = await grepTool.execute({
  pattern: 'export function',
  path: '/path/to/project',
  glob: '*.ts',
})
// matches.files contains files with matches
```

### Git Tools

```typescript
import { gitAddTool, gitCommitTool } from 'dotdo/agents/tools'

// Stage files
await gitAddTool.execute({
  path: 'src/new-feature.ts',
})

// Commit changes
await gitCommitTool.execute({
  message: 'feat: add new search feature',
})
```

---

## Tool Registry

Access all tools through the central registry:

```typescript
import { AGENT_TOOLS, getTool, executeTool } from 'dotdo/agents/tools'

// List all available tools
console.log(AGENT_TOOLS.map(t => t.name))
// ['write_file', 'read_file', 'edit_file', 'bash', 'glob', 'grep', 'git_add', 'git_commit']

// Get a specific tool
const tool = getTool('write_file')
if (tool) {
  await tool.execute({ path: '/tmp/test.txt', content: 'hello' })
}

// Execute by name (throws if not found)
const result = await executeTool('bash', { command: 'echo hello' })
```

---

## Creating Custom Tools

### Basic Tool

```typescript
import { tool } from 'dotdo/agents'
import { z } from 'zod'

const weatherTool = tool({
  name: 'getWeather',
  description: 'Get the current weather for a location',
  inputSchema: z.object({
    location: z.string().describe('City name or coordinates'),
    unit: z.enum(['celsius', 'fahrenheit']).default('celsius'),
  }),
  execute: async ({ location, unit }) => {
    const data = await fetchWeatherAPI(location, unit)
    return { temperature: data.temp, condition: data.condition }
  },
})
```

### Tool with Output Schema

```typescript
const searchTool = tool({
  name: 'search',
  description: 'Search the knowledge base',
  inputSchema: z.object({
    query: z.string(),
    limit: z.number().optional().default(10),
  }),
  outputSchema: z.object({
    results: z.array(z.object({
      title: z.string(),
      content: z.string(),
      score: z.number(),
    })),
    total: z.number(),
  }),
  execute: async ({ query, limit }) => {
    const results = await knowledgeBase.search(query, limit)
    return { results, total: results.length }
  },
})
```

### Tool Interface

Every tool implements this interface:

```typescript
interface AgentTool {
  /** Unique identifier for the tool */
  name: string
  /** Human-readable description */
  description: string
  /** JSON Schema for input parameters */
  inputSchema: {
    type: string
    properties: Record<string, { type: string; description: string }>
    required?: string[]
  }
  /** Function that executes the tool */
  execute: (input: Record<string, unknown>) => Promise<unknown>
}
```

---

## Permission Levels

Control when tools require human approval:

```typescript
const deleteTool = tool({
  name: 'deleteAccount',
  description: 'Delete a customer account',
  inputSchema: z.object({
    accountId: z.string(),
    reason: z.string(),
  }),
  execute: async ({ accountId, reason }) => {
    await accounts.delete(accountId, reason)
    return { deleted: true }
  },
  permission: 'deny', // Never allow automatically
})

const readTool = tool({
  name: 'readAccount',
  description: 'Read account details',
  inputSchema: z.object({
    accountId: z.string(),
  }),
  execute: async ({ accountId }) => {
    return accounts.get(accountId)
  },
  permission: 'auto', // Always allow
})

const updateTool = tool({
  name: 'updateBilling',
  description: 'Update billing information',
  inputSchema: z.object({
    accountId: z.string(),
    card: z.string(),
  }),
  execute: async ({ accountId, card }) => {
    await billing.update(accountId, card)
    return { updated: true }
  },
  permission: 'confirm', // Ask human first
})
```

| Level | Behavior |
|-------|----------|
| `auto` | Execute without confirmation |
| `confirm` | Ask human before executing |
| `deny` | Never execute automatically |

---

## Tool Context

Tools receive context about the execution environment:

```typescript
const contextAwareTool = tool({
  name: 'contextAware',
  description: 'A tool that uses execution context',
  inputSchema: z.object({
    action: z.string(),
  }),
  execute: async ({ action }, context) => {
    // context.agentId - which agent is calling
    // context.sessionId - current session
    // context.userId - user who initiated
    // context.abortSignal - for cancellation
    // context.metadata - custom metadata

    if (context.abortSignal?.aborted) {
      throw new Error('Operation cancelled')
    }

    await audit.log({
      agent: context.agentId,
      user: context.userId,
      action,
    })

    return { success: true }
  },
})
```

---

## Special Tool Factories

### Delegation Tool

Spawn subagents for parallel work:

```typescript
import { createDelegationTool } from 'dotdo/agents'

const delegateTool = createDelegationTool(async (task, agentId) => {
  const subagent = await spawnSubagent({ task, agentId })
  return subagent.result
})

// Agent can now delegate tasks
// "delegate this research to a specialist"
```

### Handoff Tool

Transfer conversations between specialized agents:

```typescript
import { createHandoffTool } from 'dotdo/agents'

const agents = [
  { id: 'technical', name: 'Terry', description: 'Technical support' },
  { id: 'billing', name: 'Bill', description: 'Billing questions' },
  { id: 'sales', name: 'Sally', description: 'Sales inquiries' },
]

const handoffTool = createHandoffTool(agents, async (agentId, reason) => {
  await router.handoff(agentId, reason)
})

// Agent can hand off: "transfer to billing for payment question"
```

### Finish Tool

Signal task completion:

```typescript
import { createFinishTool } from 'dotdo/agents'

const finishTool = createFinishTool()

// Agent calls when done: "finish with summary of completed work"
```

### Human Escalation Tool

Escalate to humans for decisions:

```typescript
import { createEscalationTool } from 'dotdo/agents'

const escalateTool = createEscalationTool(async (question, context) => {
  const response = await humanQueue.ask(question, context)
  return response.answer
})

// Agent can escalate: "escalate this refund request to a manager"
```

---

## Tool Selection Strategies

### Minimal Tools

Give agents only what they need:

```typescript
// Read-only agent
const researchAgent = createAgent({
  tools: [readFileTool, grepTool, globTool],
})

// Full access agent
const buildAgent = createAgent({
  tools: [...FILE_TOOLS, ...SHELL_TOOLS, ...GIT_TOOLS],
})
```

### Dynamic Tool Selection

Adjust tools based on task:

```typescript
const agent = createAgent({
  prepareStep: async (state) => {
    // First step: search and read only
    if (state.stepNumber === 1) {
      return { tools: [grepTool, readFileTool] }
    }

    // Found what to edit: add write tools
    if (state.lastStep.text?.includes('found the issue')) {
      return { tools: [editFileTool, writeFileTool] }
    }

    // Ready to commit: add git tools
    if (state.lastStep.text?.includes('ready to commit')) {
      return { tools: [gitAddTool, gitCommitTool] }
    }

    return {}
  },
})
```

### Role-Based Tools

Different tools for different roles:

```typescript
const roleTools = {
  product: [searchTool, createIssueTool],
  engineering: [...FILE_TOOLS, ...SHELL_TOOLS, ...GIT_TOOLS],
  'tech-lead': [readFileTool, grepTool, createReviewTool],
  marketing: [contentTool, scheduleTool, analyticsTool],
  sales: [crmTool, emailTool, calendarTool],
  qa: [readFileTool, bashTool, createBugTool],
}

function getToolsForRole(role: string) {
  return roleTools[role] || []
}
```

---

## Testing Tools

```typescript
import { createMockTool, createTrackedTool } from 'dotdo/agents/testing'

// Mock a tool
const mockWeather = createMockTool({
  name: 'getWeather',
  response: { temperature: 22, condition: 'sunny' },
})

// Track tool calls
const trackedBash = createTrackedTool(bashTool)
await trackedBash.execute({ command: 'ls' })

console.log(trackedBash.calls)
// [{ input: { command: 'ls' }, output: { stdout: '...' } }]
```

---

## Related

<Cards>
  <Card title="Named Agents" href="/docs/agents/named-agents">
    Pre-built agents with tools already configured.
  </Card>
  <Card title="Multi-Agent Patterns" href="/docs/agents/multi-agent">
    Orchestrate agents with delegation and handoffs.
  </Card>
  <Card title="Custom Agents" href="/docs/agents/custom-agents">
    Build agents with custom tool sets.
  </Card>
</Cards>

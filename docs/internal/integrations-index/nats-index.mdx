---
title: NATS
description: Choose between @dotdo/nats (OSS package) and nats.do (managed edge service) for your messaging needs.
---

# NATS Integration

dotdo provides two ways to work with NATS-compatible messaging APIs:

| | @dotdo/nats | nats.do |
|---|-------------|---------|
| **Type** | OSS npm package | Managed edge service |
| **Backend** | In-memory or real NATS | Durable Object SQLite |
| **Persistence** | Depends on mode | Full durability |
| **Use case** | Testing, NATS proxy | Production messaging |
| **Infrastructure** | Your NATS or none | Zero (we manage it) |
| **Install** | `npm install @dotdo/nats` | Deploy to Cloudflare |

## Quick Comparison

```typescript
// @dotdo/nats - nats.js-compatible, can proxy to real NATS
import { connect, StringCodec } from '@dotdo/nats'

const nc = await connect({ servers: 'nats://localhost:4222' })
const sc = StringCodec()

nc.publish('events', sc.encode('Hello NATS'))
// Data in-memory or forwarded to real NATS
```

```typescript
// nats.do - Native edge messaging
import { connect, StringCodec } from 'nats.do'

const nc = await connect()
const sc = StringCodec()

nc.publish('events', sc.encode('Hello NATS'))
// Data persists globally on Durable Objects
```

## When to Use Each

### Use @dotdo/nats when:

- **Migrating from nats.js** - Drop-in replacement with same API
- **Proxy to real NATS** - Connect to existing NATS clusters
- **Unit testing** - Local mode for tests without infrastructure
- **Gradual migration** - Keep using real NATS while moving to edge

<Callout type="info">
@dotdo/nats is a nats.js-compatible library. Use it when you need the familiar nats.js API or want to connect to real NATS servers.
</Callout>

### Use nats.do when:

- **Edge-native messaging** - Built for Cloudflare Workers from the ground up
- **Zero infrastructure** - No NATS server to manage
- **Global distribution** - Messages stored at the edge
- **Serverless environments** - Works without TCP connections
- **JetStream without ops** - Persistent messaging with no cluster management

<Callout type="info">
nats.do is NATS-compatible messaging built natively on Cloudflare. Use it for production edge workloads without managing infrastructure.
</Callout>

## Feature Comparison

| Feature | @dotdo/nats | nats.do |
|---------|-------------|---------|
| Pub/Sub | Yes | Yes |
| Request/Reply | Yes | Yes |
| Queue Groups | Yes | Yes |
| Subject Wildcards | Yes | Yes |
| JetStream | Yes (emulated) | Yes (DO-backed) |
| KV Store | Yes (emulated) | Yes (DO-backed) |
| Real NATS backend | Yes | No |
| Message Headers | Yes | Yes |
| Edge Compatible | Yes | Yes |
| TCP Connections | Optional | No (HTTP/RPC) |

## Getting Started

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
  <a href="/docs/integrations/nats/package" className="block p-4 border rounded-lg hover:border-primary">
    <h3 className="font-semibold">@dotdo/nats</h3>
    <p className="text-sm text-muted-foreground">nats.js-compatible messaging for migration and testing</p>
  </a>
  <a href="/docs/integrations/nats/service" className="block p-4 border rounded-lg hover:border-primary">
    <h3 className="font-semibold">nats.do</h3>
    <p className="text-sm text-muted-foreground">Managed NATS-compatible messaging on the edge</p>
  </a>
</div>

## Migration Path

Start with `@dotdo/nats` pointing to real NATS, then migrate to `nats.do`:

```typescript
// Phase 1: Use @dotdo/nats with real NATS (drop-in for nats.js)
import { connect, StringCodec } from '@dotdo/nats'

const nc = await connect({ servers: 'nats://nats.example.com:4222' })
const sc = StringCodec()

nc.publish('events', sc.encode('Hello!'))
```

```typescript
// Phase 2: Migrate to nats.do for zero-infrastructure
import { connect, StringCodec } from 'nats.do'

const nc = await connect()
const sc = StringCodec()

nc.publish('events', sc.encode('Hello!'))
// Same API, no NATS server needed
```

## Architecture Comparison

### @dotdo/nats

```
+---------------------------------------------+
|            Your Application                  |
|                                             |
|  import { connect } from '@dotdo/nats'      |
+---------------------------------------------+
                    |
        +-----------+-----------+
        |                       |
        v                       v
+---------------+     +---------------+
|  Local Mode   |     | Production    |
|  (In-memory)  |     | (Real NATS)   |
+---------------+     +---------------+
```

### nats.do

```
+---------------------------------------------+
|            Your Application                  |
|                                             |
|  import { connect } from 'nats.do'          |
+---------------------------------------------+
                    |
                    v
+---------------------------------------------+
|              nats.do Worker                 |
+-----------+-----------+---------------------+
| Pub/Sub DO | JetStream | KV Store DO        |
+-----------+-----------+---------------------+
|        Durable Object SQLite                |
+---------------------------------------------+
```

Both approaches support the same messaging patterns (pub/sub, request/reply, JetStream) - choose based on whether you need real NATS compatibility or native edge deployment.

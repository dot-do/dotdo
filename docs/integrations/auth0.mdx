---
title: Auth0
description: Drop-in replacement for Auth0 SDKs with 100% API compatibility, self-hosted on Durable Objects.
---

# Auth0

Drop-in replacement for Auth0's Node.js SDK. Your existing `auth0` code works unchanged - just swap the import.

```typescript
// Before: Auth0
import { ManagementClient, AuthenticationClient } from 'auth0'

// After: dotdo
import { ManagementClient, AuthenticationClient } from '@dotdo/auth0'

// Code stays the same
const management = new ManagementClient({
  domain: 'your-tenant.auth0.com',
  clientId: 'your-client-id',
  clientSecret: 'your-client-secret',
})

const user = await management.users.get({ id: 'user_123' })
```

## Choosing Your Mode

@dotdo/auth0 supports two distinct deployment modes. Choose based on your situation:

```
┌─────────────────────────────────────────────────────────────────────┐
│                    Which mode should I use?                         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  Are you currently paying for Auth0 Cloud?                          │
│                                                                     │
│     YES ─────────────────────┐    NO ─────────────────────┐         │
│                              │                            │         │
│                              ▼                            ▼         │
│  ┌───────────────────────────────┐  ┌───────────────────────────┐   │
│  │     Do you want to keep      │  │    SELF-HOSTED MODE       │   │
│  │     using Auth0 Cloud?       │  │    (Recommended)          │   │
│  └───────────────────────────────┘  │                           │   │
│           │              │          │  Full replacement for     │   │
│          YES            NO          │  Auth0 - your data lives  │   │
│           │              │          │  entirely in Durable      │   │
│           ▼              │          │  Objects                  │   │
│  ┌─────────────────┐     │          └───────────────────────────┘   │
│  │  PROXY MODE     │     │                                          │
│  │  (Coming Soon)  │     └──────────► SELF-HOSTED MODE              │
│  │                 │                  + Migration                   │
│  │  Integrates     │                                                │
│  │  with existing  │                                                │
│  │  Auth0 tenant   │                                                │
│  └─────────────────┘                                                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Self-Hosted Mode (Available Now)

**What it is:** A complete Auth0 reimplementation running on Durable Objects. No Auth0 servers involved.

**When to use:**
- Starting a new project and want Auth0-compatible APIs without Auth0 pricing
- Want to stop paying Auth0 and own your auth infrastructure
- Need edge-local auth (300+ cities, 0ms cold starts)
- Want unlimited API calls without rate limits

**Data flow:**
```
┌─────────────┐     ┌──────────────────┐     ┌─────────────────────┐
│  Your App   │────►│  @dotdo/auth0    │────►│  Durable Object     │
│             │◄────│  SDK             │◄────│  (SQLite)           │
└─────────────┘     └──────────────────┘     └─────────────────────┘
                           │
                           ▼
                    No Auth0 Cloud
                    connection
```

**Compliance/Security considerations:**
- Data residency: Your auth data stays in your Cloudflare account
- You control encryption keys, backups, and data retention
- SOC2/HIPAA compliance depends on your Cloudflare configuration
- No third-party data processor (Auth0) involved

### Proxy Mode (Coming Soon)

**What it is:** A compatibility layer that proxies requests to your existing Auth0 tenant while providing the dotdo SDK interface.

**When to use:**
- Already invested in Auth0 Cloud and want to keep using it
- Need Auth0-specific features (social connections, SAML, anomaly detection)
- Want to gradually evaluate dotdo without changing your auth backend
- Compliance requirements mandate using Auth0's infrastructure

**Data flow:**
```
┌─────────────┐     ┌──────────────────┐     ┌─────────────────────┐
│  Your App   │────►│  @dotdo/auth0    │────►│  Auth0 Cloud        │
│             │◄────│  SDK (Proxy)     │◄────│  (your tenant)      │
└─────────────┘     └──────────────────┘     └─────────────────────┘
                           │
                           ▼
                    Optional local
                    caching layer
```

**Compliance/Security considerations:**
- Data remains in Auth0 Cloud (subject to Auth0's compliance certifications)
- Auth0's SOC2, HIPAA BAA, and other certifications apply
- You inherit Auth0's security features (anomaly detection, breached password detection)

## Why @dotdo/auth0?

| Auth0 Cloud | auth0.do (Self-Hosted) |
|-------------|------------------------|
| Per-MAU pricing ($23/1K MAU) | Flat resource pricing |
| Single-region data residency | Edge-local in 300+ cities |
| Vendor lock-in | Self-hosted, portable |
| Rate-limited APIs | Unlimited API calls |
| Separate auth infrastructure | Unified with your DO data |

**Self-hosted mode is a reimplementation.** Your auth data lives in Durable Object SQLite - not proxied to Auth0 servers. The domain and credentials are used for namespacing and JWT configuration.

## Features

### Implemented

**ManagementClient**
- `users.create()` / `users.get()` / `users.update()` / `users.delete()` - Full CRUD
- `users.getAll()` - List all users (with pagination)
- `users.getByEmail()` - Find users by email
- `users.getRoles()` / `users.assignRoles()` / `users.removeRoles()` - Role management
- `users.getPermissions()` - Permission aggregation from roles
- `users.getEnrollments()` / `users.deleteEnrollment()` - MFA management
- `users.link()` / `users.unlink()` - Identity linking
- `connections.create()` / `connections.get()` / `connections.getByName()` / `connections.update()` / `connections.delete()` / `connections.getAll()`
- `roles.create()` / `roles.get()` / `roles.update()` / `roles.delete()` / `roles.getAll()`
- `roles.getPermissions()` / `roles.addPermissions()` / `roles.removePermissions()`
- `roles.getUsers()` - Get users assigned to a role
- `clients.create()` / `clients.get()` / `clients.update()` / `clients.delete()` / `clients.getAll()`
- `clients.rotateSecret()` - Rotate client secrets
- `resourceServers.create()` / `resourceServers.get()` / `resourceServers.update()` / `resourceServers.delete()` / `resourceServers.getAll()`

**AuthenticationClient**
- `database.signUp()` - User registration
- `database.changePassword()` - Password reset flow
- `passwordless.start()` / `passwordless.verify()` - Email/SMS passwordless
- `oauth.authorizationUrl()` - Build authorization URLs
- `oauth.token()` - Token exchange (password, refresh_token, client_credentials)
- `oauth.revokeToken()` - Token revocation
- `oauth.userInfo()` - Get user info from access token
- `mfa.challenge()` / `mfa.verify()` - MFA flows
- `mfa.associate()` / `mfa.confirmAssociation()` - MFA enrollment

### Not Yet Implemented

- Organizations API (`organizations.*`)
- User blocking (`users.block()` / `users.unblock()`)
- Custom database connections
- Social connections (Google, GitHub, etc.) - use OAuth directly
- SAML/WS-Federation
- Anomaly detection
- Breached password detection
- Attack protection
- Proxy mode to real Auth0 tenant (coming soon - see "Choosing Your Mode" above)

## Installation

```bash
npm install @dotdo/auth0
```

## Quick Start

### User Management

```typescript
import { ManagementClient } from '@dotdo/auth0'

const management = new ManagementClient({
  domain: 'your-tenant.auth0.com',
  clientId: 'your-client-id',
  clientSecret: 'your-client-secret',
})

// Create a user
const user = await management.users.create({
  email: 'alice@example.com',
  password: 'SecureP@ssw0rd!',
  connection: 'Username-Password-Authentication',
  name: 'Alice Smith',
  user_metadata: {
    preferences: { theme: 'dark' },
  },
})

console.log(`Created user: ${user.user_id}`)

// Get user by ID
const fetchedUser = await management.users.get({ id: user.user_id })

// Update user
await management.users.update(
  { id: user.user_id },
  {
    name: 'Alice Johnson',
    user_metadata: { preferences: { theme: 'light' } },
  }
)

// Find user by email
const users = await management.users.getByEmail('alice@example.com')

// Delete user
await management.users.delete({ id: user.user_id })
```

### The jwtSecret Configuration

The `jwtSecret` is used by `AuthenticationClient` to sign and verify JWT tokens (access tokens, ID tokens, refresh tokens). This is required for self-hosted mode.

**How to generate:**

```bash
# Option 1: Using OpenSSL (recommended - 256 bits)
openssl rand -base64 32

# Option 2: Using Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"

# Option 3: Using a UUID (less secure, but works)
node -e "console.log(require('crypto').randomUUID())"
```

**What it's used for:**
- Signing access tokens (HS256 algorithm by default)
- Signing ID tokens for OpenID Connect flows
- Signing refresh tokens for secure token rotation
- Verifying tokens during authentication middleware checks

**Security requirements:**
- Minimum 32 bytes (256 bits) for production use
- Store securely in environment variables, never commit to source control
- Rotate periodically (requires re-authentication of all users)
- Use different secrets per environment (dev, staging, production)

```typescript
// Example .env file
JWT_SECRET=your-32-byte-base64-secret-here

// In your code
const auth = new AuthenticationClient({
  domain: 'your-tenant.auth0.do',
  jwtSecret: process.env.JWT_SECRET,
})
```

### Authentication Flows

```typescript
import { AuthenticationClient } from '@dotdo/auth0'

const auth = new AuthenticationClient({
  domain: 'your-tenant.auth0.com',
  clientId: 'your-client-id',
  jwtSecret: process.env.JWT_SECRET, // See "The jwtSecret Configuration" above
})

// Sign up a new user
const newUser = await auth.database.signUp({
  client_id: 'your-client-id',
  email: 'bob@example.com',
  password: 'SecureP@ssw0rd!',
  connection: 'Username-Password-Authentication',
  name: 'Bob Wilson',
})

// Login with password grant
const tokens = await auth.oauth.token({
  grant_type: 'password',
  client_id: 'your-client-id',
  username: 'bob@example.com',
  password: 'SecureP@ssw0rd!',
  scope: 'openid profile email',
})

console.log('Access Token:', tokens.access_token)
console.log('ID Token:', tokens.id_token)
console.log('Refresh Token:', tokens.refresh_token)

// Refresh tokens
const refreshed = await auth.oauth.token({
  grant_type: 'refresh_token',
  client_id: 'your-client-id',
  refresh_token: tokens.refresh_token,
})

// Get user info
const userInfo = await auth.oauth.userInfo(tokens.access_token)
console.log('User:', userInfo.email, userInfo.name)

// Revoke token
await auth.oauth.revokeToken({
  client_id: 'your-client-id',
  token: tokens.refresh_token,
})
```

### Roles and Permissions

```typescript
import { ManagementClient } from '@dotdo/auth0'

const management = new ManagementClient({
  domain: 'your-tenant.auth0.com',
  token: 'management-api-token',
})

// Create a role
const adminRole = await management.roles.create({
  name: 'admin',
  description: 'Administrator with full access',
})

// Create a resource server (API)
const api = await management.resourceServers.create({
  name: 'My API',
  identifier: 'https://api.example.com',
  scopes: [
    { value: 'read:users', description: 'Read user data' },
    { value: 'write:users', description: 'Modify user data' },
    { value: 'delete:users', description: 'Delete users' },
  ],
})

// Add permissions to role
await management.roles.addPermissions(
  { id: adminRole.id },
  {
    permissions: [
      { permission_name: 'read:users', resource_server_identifier: 'https://api.example.com' },
      { permission_name: 'write:users', resource_server_identifier: 'https://api.example.com' },
      { permission_name: 'delete:users', resource_server_identifier: 'https://api.example.com' },
    ],
  }
)

// Assign role to user
await management.users.assignRoles(
  { id: 'user_123' },
  { roles: [adminRole.id] }
)

// Get user's effective permissions
const permissions = await management.users.getPermissions({ id: 'user_123' })
console.log('User permissions:', permissions.map(p => p.permission_name))
// ['read:users', 'write:users', 'delete:users']
```

### MFA (Multi-Factor Authentication)

```typescript
import { AuthenticationClient } from '@dotdo/auth0'

const auth = new AuthenticationClient({
  domain: 'your-tenant.auth0.com',
  jwtSecret: process.env.JWT_SECRET,
})

// Enroll TOTP authenticator
const enrollment = await auth.mfa.associate({
  client_id: 'your-client-id',
  access_token: userAccessToken,
  authenticator_types: ['otp'],
})

console.log('TOTP Secret:', enrollment.secret)
console.log('QR Code URI:', enrollment.barcode_uri)

// Confirm enrollment with first OTP
await auth.mfa.confirmAssociation({
  client_id: 'your-client-id',
  access_token: userAccessToken,
  factor_id: enrollment.factor_id,
  otp: '123456', // From authenticator app
})

// During login - MFA challenge
const challenge = await auth.mfa.challenge({
  client_id: 'your-client-id',
  mfa_token: mfaToken, // Returned when MFA is required
  challenge_type: 'otp',
})

// Verify MFA
const tokens = await auth.mfa.verify({
  client_id: 'your-client-id',
  mfa_token: mfaToken,
  otp: '654321',
})
```

### Passwordless Authentication

```typescript
import { AuthenticationClient } from '@dotdo/auth0'

const auth = new AuthenticationClient({
  domain: 'your-tenant.auth0.com',
  jwtSecret: process.env.JWT_SECRET,
})

// Start passwordless flow (email)
const { _id } = await auth.passwordless.start({
  client_id: 'your-client-id',
  connection: 'email',
  email: 'user@example.com',
  send: 'code',
})

// User receives code via email...

// Verify code and get tokens
const tokens = await auth.passwordless.verify({
  client_id: 'your-client-id',
  connection: 'email',
  email: 'user@example.com',
  verification_code: '123456',
  scope: 'openid profile email',
})
```

## Inbound Compatibility (auth0.do as Auth Provider)

Use auth0.do as a drop-in replacement for Auth0. Your frontend code works unchanged:

```typescript
// Using @auth0/auth0-react
import { Auth0Provider, useAuth0 } from '@auth0/auth0-react'

function App() {
  return (
    <Auth0Provider
      domain="your-app.auth0.do" // Point to auth0.do
      clientId="your-client-id"
      authorizationParams={{
        redirect_uri: window.location.origin,
      }}
    >
      <MyApp />
    </Auth0Provider>
  )
}

function LoginButton() {
  const { loginWithRedirect, logout, user, isAuthenticated } = useAuth0()

  if (isAuthenticated) {
    return (
      <div>
        <p>Welcome, {user?.name}!</p>
        <button onClick={() => logout()}>Log out</button>
      </div>
    )
  }

  return <button onClick={() => loginWithRedirect()}>Log in</button>
}
```

```typescript
// Using @auth0/auth0-spa-js
import { createAuth0Client } from '@auth0/auth0-spa-js'

const auth0 = await createAuth0Client({
  domain: 'your-app.auth0.do',
  clientId: 'your-client-id',
})

await auth0.loginWithRedirect()
const user = await auth0.getUser()
const token = await auth0.getTokenSilently()
```

```typescript
// Using @auth0/nextjs-auth0
// pages/api/auth/[...auth0].ts
import { handleAuth } from '@auth0/nextjs-auth0'

export default handleAuth()

// Configured via environment variables:
// AUTH0_ISSUER_BASE_URL=https://your-app.auth0.do
// AUTH0_CLIENT_ID=your-client-id
// AUTH0_CLIENT_SECRET=your-client-secret
```

## Integration with dotdo Auth Middleware

Use the Auth0 compat layer with dotdo's auth middleware for seamless authentication:

```typescript
import { Hono } from 'hono'
import { authMiddleware, requireAuth } from '@dotdo/api/middleware/auth'
import { AuthenticationClient } from '@dotdo/auth0'

const app = new Hono()

// Configure auth middleware with JWKS from auth0.do
app.use('*', authMiddleware({
  jwksUrl: 'https://your-app.auth0.do/.well-known/jwks.json',
  publicPaths: ['/public', '/health'],
}))

// Protected routes
app.get('/api/profile', requireAuth(), async (c) => {
  const auth = c.get('auth')
  return c.json({ userId: auth.userId, email: auth.email })
})

// Use AuthenticationClient for token operations
const auth = new AuthenticationClient({
  domain: 'your-app.auth0.do',
  jwtSecret: env.JWT_SECRET,
})

app.post('/api/auth/token', async (c) => {
  const body = await c.req.json()

  const tokens = await auth.oauth.token({
    grant_type: 'password',
    client_id: body.client_id,
    username: body.username,
    password: body.password,
  })

  return c.json(tokens)
})
```

## TypeScript Types

Full TypeScript support with Auth0-compatible types:

```typescript
import type {
  // User types
  Auth0User,
  Auth0Identity,
  CreateUserParams,
  UpdateUserParams,

  // Connection types
  Auth0Connection,
  ConnectionOptions,
  CreateConnectionParams,

  // Role types
  Auth0Role,
  Auth0Permission,
  CreateRoleParams,

  // Client types
  Auth0Client,
  CreateClientParams,

  // Resource server types
  Auth0ResourceServer,
  CreateResourceServerParams,

  // Token types
  TokenResponse,
  AuthorizationParams,
  TokenExchangeParams,

  // Auth types
  SignupParams,
  ChangePasswordParams,
  PasswordlessStartParams,
  PasswordlessVerifyParams,

  // MFA types
  Auth0MFAEnrollment,
  Auth0MFAChallenge,

  // Log types
  Auth0Log,

  // Error types
  Auth0Error,

  // Pagination types
  PaginationParams,
  PaginatedResponse,
} from '@dotdo/auth0'

// Error class
import { Auth0APIError } from '@dotdo/auth0'
```

## Error Handling

```typescript
import { Auth0APIError } from '@dotdo/auth0'

try {
  await management.users.get({ id: 'invalid-user-id' })
} catch (error) {
  if (error instanceof Auth0APIError) {
    console.error('Status:', error.statusCode)      // 404
    console.error('Message:', error.message)        // 'User not found: invalid-user-id'
    console.error('Error Code:', error.errorCode)   // 'inexistent_user'
    console.error('Error:', error.error)            // 'Not Found'
  }
}
```

### Auth0APIError Properties

| Property | Type | Description |
|----------|------|-------------|
| `statusCode` | `number` | HTTP status code (e.g., 404, 401, 400) |
| `error` | `string` | Error type (e.g., 'Not Found', 'Unauthorized') |
| `message` | `string` | Human-readable error message |
| `errorCode` | `string?` | Auth0-specific error code (optional) |

### Common Error Codes

| Code | HTTP Status | Description |
|------|-------------|-------------|
| `inexistent_user` | 404 | User not found |
| `inexistent_connection` | 404 | Connection not found |
| `invalid_body` | 400 | Invalid request body |
| `invalid_query_string` | 400 | Invalid query parameters |
| `password_strength_error` | 400 | Password too weak |
| `user_exists` | 409 | User with email already exists |
| `invalid_token` | 401 | Token is invalid or expired |
| `insufficient_scope` | 403 | Token lacks required scopes |

### Authentication Errors

```typescript
import { AuthenticationClient, Auth0APIError } from '@dotdo/auth0'

const auth = new AuthenticationClient({
  domain: 'your-tenant.auth0.do',
  jwtSecret: process.env.JWT_SECRET,
})

try {
  await auth.oauth.token({
    grant_type: 'password',
    client_id: 'your-client-id',
    username: 'user@example.com',
    password: 'wrong-password',
  })
} catch (error) {
  if (error instanceof Auth0APIError) {
    switch (error.errorCode) {
      case 'invalid_grant':
        console.error('Invalid username or password')
        break
      case 'mfa_required':
        console.error('MFA required - use mfa.challenge() and mfa.verify()')
        break
      case 'too_many_attempts':
        console.error('Account locked due to too many failed attempts')
        break
    }
  }
}
```

## Architecture

Auth data is stored in Durable Object SQLite with the shared auth primitives:

```
+----------------------------------------------------------+
|          ManagementClient / AuthenticationClient          |
+----------------------------------------------------------+
                            |
                            v
+----------------------------------------------------------+
|                   Shared Auth Layer                       |
|  +------------------+  +------------------+               |
|  |   UserManager    |  |  SessionManager  |               |
|  |  - CRUD users    |  |  - JWT tokens    |               |
|  |  - Passwords     |  |  - Sessions      |               |
|  |  - Identities    |  |  - Refresh       |               |
|  +------------------+  +------------------+               |
|  +------------------+  +------------------+               |
|  |   MFAManager     |  |  OAuthManager    |               |
|  |  - TOTP          |  |  - Grants        |               |
|  |  - Email/SMS OTP |  |  - PKCE          |               |
|  |  - Challenges    |  |  - Revocation    |               |
|  +------------------+  +------------------+               |
+----------------------------------------------------------+
                            |
                            v
+----------------------------------------------------------+
|              Durable Object (DO)                          |
|  +----------------------------------------------------+  |
|  |                    SQLite                           |  |
|  |  - users, sessions, mfa_factors                     |  |
|  |  - roles, permissions, connections                  |  |
|  |  - clients, resource_servers                        |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

## Migration from Auth0

### Package Change

```bash
# Remove
npm uninstall auth0

# Install
npm install @dotdo/auth0
```

### Import Change

```typescript
// Before
import { ManagementClient, AuthenticationClient } from 'auth0'

// After
import { ManagementClient, AuthenticationClient } from '@dotdo/auth0'
```

### Data Migration

Export users from Auth0 and import to auth0.do:

```typescript
import { ManagementClient as Auth0Client } from 'auth0'
import { ManagementClient as DotdoClient } from '@dotdo/auth0'

// Source: Auth0
const auth0 = new Auth0Client({
  domain: 'your-tenant.auth0.com',
  clientId: process.env.AUTH0_CLIENT_ID,
  clientSecret: process.env.AUTH0_CLIENT_SECRET,
})

// Destination: dotdo
const dotdo = new DotdoClient({
  domain: 'your-app.auth0.do',
  clientId: 'local-client-id',
  clientSecret: 'local-client-secret',
})

// Migrate users
const users = await auth0.users.getAll()

for (const user of users) {
  await dotdo.users.create({
    email: user.email,
    connection: 'Username-Password-Authentication',
    name: user.name,
    user_metadata: user.user_metadata,
    app_metadata: user.app_metadata,
    email_verified: user.email_verified,
    // Note: Passwords can't be migrated - users need to reset
  })
}
```

## Limitations

What's different from Auth0 Cloud:

| Feature | Status | Notes |
|---------|--------|-------|
| User management | Full | CRUD, metadata, identity linking |
| Password auth | Full | Signup, login, reset |
| JWT tokens | Full | HS256, RS256 support |
| Refresh tokens | Full | Rotation, revocation |
| MFA (TOTP) | Full | Enrollment, verification |
| MFA (Email/SMS) | Full | OTP delivery (bring your own transport) |
| Roles & Permissions | Full | RBAC with inheritance |
| Connections | Full | Create, update, delete connections |
| Clients | Full | Application management with secret rotation |
| Resource Servers | Full | API definitions with scopes |
| User blocking | Not implemented | Use user deletion or custom metadata |
| Organizations | Not implemented | Multi-tenancy planned |
| Social connections | Not implemented | Use OAuth directly |
| SAML | Not implemented | |
| Custom database | Not implemented | |
| Anomaly detection | Not implemented | |
| Breached passwords | Not implemented | |
| Proxy to Auth0 | Coming soon | See "Proxy Mode" above - will integrate with existing Auth0 tenants |

## Related

- [Authentication Overview](/docs/security/authentication) - dotdo auth concepts
- [Authorization](/docs/security/authorization) - Permission systems
- [Clerk Integration](/docs/integrations/clerk) - Alternative auth provider

---
title: PostgreSQL
description: Choose between @dotdo/postgres (OSS package) and postgres.do (managed edge service) for your PostgreSQL needs.
---

# PostgreSQL Integration

dotdo provides two ways to work with PostgreSQL-compatible APIs:

| | @dotdo/postgres | postgres.do |
|---|-----------------|-------------|
| **Type** | OSS npm package | Managed edge service |
| **Storage** | DO SQLite (pg-compatible) | Full Postgres (PGLite WASM) |
| **Persistence** | Durable | Durable |
| **Use case** | Testing, migrations, pg compatibility | Production AI/vector workloads |
| **Infrastructure** | Zero | Zero (we manage it) |
| **Install** | `npm install @dotdo/postgres` | Deploy to Cloudflare |

## Quick Comparison

```typescript
// @dotdo/postgres - Drop-in pg replacement
import { Client } from '@dotdo/postgres'

const client = new Client('postgres://localhost/mydb')
await client.connect()
const { rows } = await client.query('SELECT * FROM users WHERE id = $1', [1])
// Same pg API, backed by DO SQLite
```

```typescript
// postgres.do - Full Postgres with pgvector
import { EdgePostgres } from 'postgres.do'

const db = new EdgePostgres(ctx, env, {
  pglite: { extensions: ['pgvector'] }
})

const similar = await db.query(`
  SELECT content, 1 - (embedding <=> $1) AS similarity
  FROM documents
  ORDER BY embedding <=> $1
  LIMIT 10
`, [queryEmbedding])
// Full Postgres + pgvector on the edge
```

## When to Use Each

### Use @dotdo/postgres when:

- **Migrating from pg** - Drop-in replacement, same API, no code changes
- **Unit testing** - Fast, isolated tests without external dependencies
- **ORM compatibility** - Works with Drizzle, Kysely, and other pg-compatible ORMs
- **CI/CD pipelines** - Tests that need pg semantics

<Callout type="info">
@dotdo/postgres is a pg-compatible layer backed by DO SQLite. Your existing pg code works unchanged - just swap the import.
</Callout>

### Use postgres.do when:

- **Vector search** - pgvector for semantic similarity, RAG, AI agents
- **Full Postgres syntax** - Complex queries, JSON operators, full-text search
- **AI workloads** - Embeddings, HNSW indexes, hybrid search
- **Edge deployment** - Global edge execution with checkpointing

<Callout type="info">
postgres.do is EdgePostgres - full Postgres (PGLite WASM) with pgvector running in Durable Objects on Cloudflare's global network.
</Callout>

## Feature Comparison

| Feature | @dotdo/postgres | postgres.do |
|---------|-----------------|-------------|
| pg Client API | Full | N/A (native Postgres) |
| pg Pool API | Full | N/A |
| Parameterized queries | Yes | Yes |
| Transactions | Yes | Yes (ACID) |
| pgvector | No | Yes |
| HNSW indexes | No | Yes |
| Full-text search | Basic | Full |
| JSON operators | Basic | Full (`->`, `->>`, `@>`) |
| Checkpointing | N/A | Yes |
| Vector quantization | No | Yes (4x compression) |
| Hybrid search | No | Yes |
| ORM support | Drizzle, Kysely | Direct queries |
| COPY commands | No | N/A |
| Pub/Sub (LISTEN/NOTIFY) | No | N/A |

## Getting Started

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
  <a href="/docs/integrations/postgres/package" className="block p-4 border rounded-lg hover:border-primary">
    <h3 className="font-semibold">@dotdo/postgres</h3>
    <p className="text-sm text-muted-foreground">Drop-in pg replacement for testing and edge compatibility</p>
  </a>
  <a href="/docs/integrations/postgres/service" className="block p-4 border rounded-lg hover:border-primary">
    <h3 className="font-semibold">postgres.do</h3>
    <p className="text-sm text-muted-foreground">Full Postgres with pgvector on the edge for production</p>
  </a>
</div>

## Migration Path

Start with `@dotdo/postgres` for compatibility, upgrade to `postgres.do` for advanced features:

```typescript
// Development/testing (package) - pg-compatible
import { Client } from '@dotdo/postgres'
const client = new Client()
await client.connect()
const { rows } = await client.query('SELECT * FROM users WHERE id = $1', [1])

// Production AI workloads (service) - full Postgres + pgvector
import { EdgePostgres } from 'postgres.do'
const db = new EdgePostgres(ctx, env, {
  pglite: { extensions: ['pgvector'] }
})
const results = await db.query(`
  SELECT * FROM documents
  ORDER BY embedding <=> $1
  LIMIT 10
`, [queryEmbedding])
```

Choose `@dotdo/postgres` for pg API compatibility, `postgres.do` for full Postgres power with vector search.

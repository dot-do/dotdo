---
title: Events
description: Event-driven architecture with Noun.verb patterns
---

# Events

dotdo uses a Noun.verb pattern for natural, expressive event handling.

## Event Handlers

Register handlers with `$.on.Noun.verb(handler)`. Handlers receive a `DomainEvent` with typed payload:

```typescript
// Customer events
$.on.Customer.signup(async (event) => {
  const { id, email, name } = event.data
  await sendWelcomeEmail(event.data)
  await notifySales(event.data)
})

// Payment events
$.on.Payment.succeeded(async (event) => {
  await fulfillOrder(event.data.orderId)
})

$.on.Payment.failed(async (event) => {
  await notifyCustomer(event.data.customerId)
  await scheduleRetry(event.data)
})

// Order events
$.on.Order.placed(processOrder)
$.on.Order.shipped(notifyCustomer)
$.on.Order.delivered(requestReview)
```

## DomainEvent Structure

Every handler receives a `DomainEvent` object:

```typescript
interface DomainEvent<TData = unknown> {
  id: string          // Unique event identifier
  verb: string        // The action (e.g., "signup", "placed")
  source: string      // Source DO namespace
  data: TData         // Your event payload
  actionId?: string   // Optional triggering action ID
  timestamp: Date     // When the event occurred
}
```

## Emitting Events

Use `$.send()` for fire-and-forget event emission:

```typescript
// Fire-and-forget event emission
this.$.send('Customer.signup', { id, email, name })
this.$.send('Payment.succeeded', { id, amount, orderId })
this.$.send('Order.placed', { id, items, customerId })
```

## Handler Options

Handlers support optional configuration:

```typescript
$.on.Order.placed(handler, {
  priority: 10,           // Higher priority runs first (default: 0)
  name: 'inventoryHandler', // Handler name for debugging
  maxRetries: 5,          // DLQ retry limit (default: 3)
  filter: async (event) => event.data.total > 100, // Conditional execution
})
```

## Wildcard Patterns

Match multiple events with wildcards:

```typescript
// All events for a noun (event sourcing pattern)
$.on.Account['*'](async (event) => {
  await eventStore.append(event)
})

// All nouns with specific verb
$.on['*'].created(async (event) => {
  await auditLog.record(event)
})

// Global handler (all events)
$.on['*']['*'](async (event) => {
  console.log('Event:', event.verb, event.source)
})
```

## Handler Priority

Handlers execute in priority order (highest first), then registration order:

```typescript
// Runs first (priority 10)
$.on.Order.placed(validateOrder, { priority: 10 })

// Runs second (priority 5)
$.on.Order.placed(updateInventory, { priority: 5 })

// Runs last (default priority 0)
$.on.Order.placed(sendConfirmation)
```

## Error Handling

Handler errors are captured and failed events go to the Dead Letter Queue (DLQ):

```typescript
$.on.Order.placed(async (event) => {
  // If this throws, event goes to DLQ after retries exhausted
  await processOrder(event.data)
})

// Handlers should be idempotent for retry safety
$.on.Payment.captured(async (event) => {
  const existing = await checkIfProcessed(event.id)
  if (existing) return // Skip duplicate

  await processCapture(event.data)
  await markAsProcessed(event.id)
})
```

## Related

- [Event Emission](/docs/events/emission) - Detailed emission patterns with $.send, $.try, $.do
- [Concepts: Actions](/docs/concepts/actions) - The Noun.verb pattern
- [SDK: WorkflowContext](/docs/sdk/workflow-context) - The $ proxy reference

---
title: Capabilities
description: Capability modules for filesystem, git, and shell access
---

import { AutoTypeTable } from 'fumadocs-typescript/ui'

# Capabilities

Capability modules provide domain-specific functionality to workflows through the WorkflowContext ($). They are lazy-loaded and cached on first access.

## FsCapability

Filesystem capability for workflows that need file access.

<AutoTypeTable type="FsCapability" />

### Methods

| Method | Description |
|--------|-------------|
| `read(path, options?)` | Read file contents as string |
| `write(path, content, options?)` | Write content to file |
| `list(path, options?)` | List directory entries |
| `exists(path)` | Check if path exists |
| `delete(path)` | Delete file or directory |
| `mkdir(path, options?)` | Create directory |
| `stat(path)` | Get file/directory metadata |
| `copy(src, dest)` | Copy file |
| `move(src, dest)` | Move/rename file |

### Usage

```typescript
const processConfig = async ($: WorkflowContext) => {
  if (!hasFs($)) {
    throw new CapabilityError('fs', 'not_available', 'Filesystem required')
  }

  const config = await $.fs.read('/config.json')
  const parsed = JSON.parse(config)
  return parsed
}
```

## GitCapability

Git capability for workflows that need version control.

<AutoTypeTable type="GitCapability" />

### Methods

| Method | Description |
|--------|-------------|
| `status()` | Get repository status |
| `add(files)` | Stage files for commit |
| `commit(message)` | Create a commit |
| `push(remote?, branch?)` | Push to remote |
| `pull(remote?, branch?)` | Pull from remote |
| `log(options?)` | Get commit history |
| `diff(ref?)` | Get diff output |

### Usage

```typescript
const commitChanges = async ($: WorkflowContext) => {
  if (!hasGit($)) {
    throw new CapabilityError('git', 'not_available', 'Git required')
  }

  const status = await $.git.status()
  if (status.unstaged.length > 0) {
    await $.git.add(status.unstaged)
    await $.git.commit('Auto-commit changes')
  }
}
```

## BashCapability

Bash capability for workflows that need shell access.

<AutoTypeTable type="BashCapability" />

### Methods

| Method | Description |
|--------|-------------|
| `exec(command, options?)` | Execute command and wait |
| `spawn(command, args?)` | Spawn child process |

### Usage

```typescript
const runBuild = async ($: WorkflowContext) => {
  if (!hasBash($)) {
    throw new CapabilityError('bash', 'not_available', 'Bash required')
  }

  const result = await $.bash.exec('npm run build', { cwd: '/app' })
  if (result.exitCode !== 0) {
    throw new Error(`Build failed: ${result.stderr}`)
  }
  return result.stdout
}
```

## Type Guards

Type guards for capability checking:

```typescript
// Check for filesystem capability
if (hasFs($)) {
  // $ is now typed as WithFs
  await $.fs.read('/data.json')
}

// Check for git capability
if (hasGit($)) {
  // $ is now typed as WithGit
  const status = await $.git.status()
}

// Check for bash capability
if (hasBash($)) {
  // $ is now typed as WithBash
  await $.bash.exec('echo hello')
}

// Check for all capabilities
if (hasAllCapabilities($)) {
  // $ is now typed as WithAllCapabilities
}
```

## CapabilityError

Error thrown when a capability is not available:

```typescript
throw new CapabilityError(
  'fs',
  'not_available',
  'Filesystem capability is required for this operation'
)
```

### Reasons

- `not_available` - Capability not loaded
- `permission_denied` - Access denied
- `load_failed` - Failed to initialize

## Related Types

- [WorkflowContext](/docs/sdk/workflow-context) - The $ context interface
- [WithFs, WithGit, WithBash](/docs/sdk/workflow-context#type-helpers) - Composed context types

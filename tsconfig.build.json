{
  "extends": "./tsconfig.json",
  "compilerOptions": {
    // Output configuration
    "outDir": "dist",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "noEmit": false,

    // Library output settings
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "bundler",

    // Add .js extensions to relative imports for Node.js compatibility
    "rewriteRelativeImportExtensions": true,

    // Remove most path aliases for published package, keep stubs for missing deps
    "paths": {
      "fsx.do": ["./types/stubs/fsx.do.d.ts"],
      "@dotdo/fsx": ["./types/stubs/dotdo-fsx.d.ts"],
      "@dotdo/client": ["./types/stubs/dotdo-client.d.ts"]
    },

    // Ensure clean output
    "removeComments": false,
    "emitDeclarationOnly": false,

    // Relax strictness for declaration emit (mixin patterns)
    "stripInternal": true,

    // Skip checking declarations from dependencies
    "skipLibCheck": true,

    // Emit output even with type errors (the package has many pre-existing errors)
    "noEmitOnError": false
  },
  "include": [
    // All DO entry points
    "do/**/*.ts",
    // Core objects (includes presets/)
    "objects/**/*.ts",
    // Types and utilities
    "types/**/*.ts",
    "snippets/**/*.ts",
    // Library (includes mixins for fs/git/bash capabilities)
    "lib/**/*.ts",
    // Workflows (core only, not compat)
    "workflows/**/*.ts",
    "metrics/**/*.ts",
    // Streams (Cloudflare Pipelines SQL definitions)
    "streams/**/*.ts"
  ],
  "exclude": [
    "node_modules",
    "dist",
    "app",
    "examples",
    "packages",
    "primitives",
    "**/*.test.ts",
    "**/*.test.tsx",
    "**/tests/**",
    "**/spikes/**",
    // Exclude compat layer - has many type errors and external deps
    "compat/**/*",
    "streaming/**/*",
    "db/**/*",
    "analytics/**/*",
    "evals/**/*",
    // Exclude workflows compat (has compat deps)
    "workflows/compat/**/*",
    // Exclude files with known build issues (to be fixed in separate PRs)
    "cli/**/*",
    "auth/**/*",
    "api/**/*",
    // Missing dependencies
    "do/payments/**/*",
    // objects/mixins now uses lib/mixins which only imports types from @dotdo/fsx
    // Files depending on @dotdo/client package (runtime not available during build)
    "lib/agent/**/*",
    "sdk/**/*",
    // Files depending on compat graph (db/compat)
    "lib/tools/provider-bridge.ts",
    // Directories that import from compat/ or have unresolved type errors
    "lib/tools/**/*",
    "lib/benchmarks/**/*",
    "lib/validation/**/*",
    "lib/executors/**/*",
    "lib/human/**/*",
    "lib/iterators/**/*",
    "lib/storage/chunked-upload.ts",
    "lib/support/escalation.ts",
    // Objects with type errors that are not imported by critical paths
    "objects/StatelessDOState.ts",
    "objects/CollectionDO.ts",
    "objects/mixins/npm.ts",
    // Agents - has graph dependencies and type errors
    "agents/**/*",
    // Workflow error escalation
    "workflows/errors/**/*",
    // Workflow graph - has many type conversion issues
    "workflows/graph/**/*",
    // Workflow core - has type errors
    "workflows/core/**/*",
    // Workflow context shard - has type errors
    "workflows/context/shard.ts",
    // Object transport - has type errors
    "objects/transport/**/*",
    // Types with stub dependencies
    "types/stubs/**/*",
    // Store types with complex DB dependencies
    "types/stores.ts"
  ]
}
